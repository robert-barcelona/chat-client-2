(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{44:function(e,a,n){e.exports=n(63)},50:function(e,a,n){},63:function(e,a,n){"use strict";n.r(a);var s=n(2),t=n.n(s),r=n(29),o=n.n(r),c=n(9),i=n(10),l=n(41),m=n(40),u=n(38),g=n(23),d=n.n(g),v=n(30),p=n(31),E=n(32),f=n(39),h=n(33),y=n(42),N=n(11),k=n(12),D=n.n(k);n(50);function b(){var e=Object(N.a)(["\n  {\n    sessionToken @client\n  }\n"]);return b=function(){return e},e}function I(){var e=Object(N.a)(["\n  {\n    sessionID @client\n  }\n"]);return I=function(){return e},e}function w(){var e=Object(N.a)(["\n  mutation sendMessage($sessionToken: String!, $sessionID: String!,$message:String!) {\n    sendMessage(sessionToken: $sessionToken, sessionID: $sessionID,message:$message) {\n      addlData\n      conversationFragment {\n        reply\n      }\n    }\n  }\n"]);return w=function(){return e},e}function C(){var e=Object(N.a)(["\n  query GetConversations($sessionID:String!) {\n    getConversations(sessionID:$sessionID) {\n      message\n      reply\n      added\n    }\n  }\n"]);return C=function(){return e},e}function S(){var e=Object(N.a)(["\n  query GetConversationCredentials {\n    getConversationCredentials {\n      sessionToken\n      sessionID\n    }\n  }\n"]);return S=function(){return e},e}var T=D()(S()),O=D()(C()),M=D()(w()),j=D()(I()),x=D()(b()),q=function(e){function a(){var e,n;Object(p.a)(this,a);for(var s=arguments.length,r=new Array(s),o=0;o<s;o++)r[o]=arguments[o];return(n=Object(f.a)(this,(e=Object(h.a)(a)).call.apply(e,[this].concat(r)))).state={message:""},n.messageRef=t.a.createRef(),n.setMessage=function(e){n.setState({message:e.target.value})},n}return Object(y.a)(a,e),Object(E.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.client,a=localStorage.getItem("sessionToken"),n=localStorage.getItem("sessionID");a&&n&&e.writeData({data:{sessionToken:a,sessionID:n}})}},{key:"render",value:function(){var e=this,a=this.state,n=a.message,s=a.sessionToken,r=a.sessionID;return t.a.createElement(c.c,{query:T},function(a){var o=a.data,i=a.error,l=a.loading,m=a.client;return!o||!o.getConversationCredentials||r&&s||(r=m.readQuery({query:j}).sessionID||o.getConversationCredentials.sessionID,s=m.readQuery({query:x}).sessionToken||o.getConversationCredentials.sessionToken,localStorage.setItem("sessionID",r),localStorage.setItem("sessionToken",s),console.log("processing data",o.getConversationCredentials,"sessionID",r,"sessionToken",s),s&&r&&m.writeData({data:{sessionToken:s,sessionID:r}})),l?"Loading...":i?t.a.createElement("div",{className:"message is-warning"},t.a.createElement("div",{className:"message-header"},"Error in GET_CONVERSATION_CREDENTIALS Query: ".concat(i.toString()))):t.a.createElement("div",{className:"container main"},t.a.createElement("div",{className:"hero"},t.a.createElement("div",{className:"hero-body has-background-warning"},"Chatomatic 2000")),t.a.createElement("div",{className:"columns"},t.a.createElement("div",{className:"column is-two-thirds"},t.a.createElement(c.b,{mutation:M,refetchQueries:function(){return[{query:O,variables:{sessionID:r}}]}},function(a,o){var c=o.data,i=o.error,l=o.loading;o.client;return console.log("mutation data",c),t.a.createElement("div",{className:"columns"},t.a.createElement("div",{className:"column is-half"},i&&t.a.createElement("div",{className:"message is-warning"},t.a.createElement("div",{className:"message-header"},"Error in SEND_MESSAGE Mutation: ".concat(i.toString()))),t.a.createElement("form",{onSubmit:function(){var t=Object(v.a)(d.a.mark(function t(o){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o.preventDefault(),t.prev=1,!n){t.next=5;break}return t.next=5,a({variables:{sessionToken:s,sessionID:r,message:n}});case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.log(t.t0.message);case 10:e.messageRef.current&&(e.messageRef.current.value="");case 11:case"end":return t.stop()}},t,null,[[1,7]])}));return function(e){return t.apply(this,arguments)}}()},t.a.createElement("div",{className:"field"},t.a.createElement("p",{className:"control has-icons-left has-icons-right"},t.a.createElement("input",{ref:e.messageRef,value:n,onChange:e.setMessage,className:"input",type:"text",placeholder:"Message..."}),t.a.createElement("span",{className:"icon is-small is-left"},t.a.createElement("i",{className:"fas fa-pencil"})))),t.a.createElement("div",{className:"field"},t.a.createElement("p",{className:"control"},t.a.createElement("button",{className:"button is-success"},"Send")))),l&&t.a.createElement("h3",null,"Writing...")),t.a.createElement("div",{className:"column is-half"},c&&c.sendMessage&&c.sendMessage.conversationFragment&&t.a.createElement("div",{className:"reply  has-text-white"},t.a.createElement("span",{className:"reply-title"},"Chatomatic says: "),c.sendMessage.conversationFragment.reply),c&&c.sendMessage&&t.a.createElement("div",{className:"reply  has-text-white"},c.sendMessage.addlData.map(function(e,a){return t.a.createElement("div",{key:a},e)}))))})),t.a.createElement("div",{className:"column is-one-third"},t.a.createElement(c.c,{query:O,variables:{sessionID:r}},function(e){var a=e.data,n=e.loading,s=e.error;return s?s.message:n?"Loading...":t.a.createElement("div",{className:"list"},a&&a.getConversations&&a.getConversations.map(function(e,a){return t.a.createElement("div",{className:"list-item history",key:a},t.a.createElement("span",{className:" history-message"},t.a.createElement("span",{className:"has-text-success history-message-title"},"You: "),e.message),t.a.createElement("br",null),t.a.createElement("span",{className:"history-reply"},t.a.createElement("span",{className:"has-text-success history-reply-title"},"Chatomatic: "),e.reply),t.a.createElement("br",null),t.a.createElement("span",{className:"history-date"},e.added))}))}))))})}}]),a}(s.Component),$=Object(c.d)(q),R=(n(58),Object(u.a)(function(e){var a=e.graphQLErrors,n=e.networkError;a&&a.map(function(e){var a=e.message,n=e.locations,s=e.path;return console.log("[GraphQL error]: Message: ".concat(a,", Location: ").concat(n,", Path: ").concat(s))}),n&&console.log("[Network error]: ".concat(n))})),L=new m.a;L.writeData({data:{sessionID:"",sessionToken:""}});var Q=new i.a({link:R.concat(new l.a({uri:"https://limitless-atoll-59109.herokuapp.com/graphql"})),cache:L});o.a.render(t.a.createElement(c.a,{client:Q},t.a.createElement($,null)),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.cf7ff3e2.chunk.js.map